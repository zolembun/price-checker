import streamlit as st
import google.generativeai as genai

st.set_page_config(page_title="Model Checker", page_icon="üõ†")

st.title("üõ†Ô∏è ‡πÄ‡∏ä‡πá‡∏Ñ‡∏ä‡∏∑‡πà‡∏≠‡πÇ‡∏°‡πÄ‡∏î‡∏• Gemini ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡πÑ‡∏î‡πâ")

# ‡∏î‡∏∂‡∏á API Key ‡∏à‡∏≤‡∏Å Secrets (‡πÉ‡∏ä‡πâ‡∏ï‡∏±‡∏ß‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ö app.py)
try:
    api_key = st.secrets["gemini_api_key"]
    genai.configure(api_key=api_key)
    
    if st.button("‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÇ‡∏°‡πÄ‡∏î‡∏• (Scan Models)"):
        with st.spinner("‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ Google AI..."):
            try:
                available_models = []
                # ‡∏î‡∏∂‡∏á‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡πÇ‡∏°‡πÄ‡∏î‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
                for m in genai.list_models():
                    # ‡∏Å‡∏£‡∏≠‡∏á‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ï‡∏±‡∏ß‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ Chat ‡πÑ‡∏î‡πâ (generateContent)
                    if 'generateContent' in m.supported_generation_methods:
                        clean_name = m.name.replace('models/', '')
                        available_models.append(clean_name)
                
                if available_models:
                    st.success(f"‚úÖ ‡∏û‡∏ö {len(available_models)} ‡πÇ‡∏°‡πÄ‡∏î‡∏•‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡πÑ‡∏î‡πâ:")
                    
                    # ‡πÅ‡∏™‡∏î‡∏á‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡πÅ‡∏•‡∏∞‡πÇ‡∏Ñ‡πâ‡∏î‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡πä‡∏≠‡∏õ‡∏õ‡∏µ‡πâ
                    for model_name in available_models:
                        col1, col2 = st.columns([3, 1])
                        with col1:
                            st.code(f"model = genai.GenerativeModel('{model_name}')")
                        with col2:
                            if "flash" in model_name:
                                st.caption("‚ö° ‡πÄ‡∏£‡πá‡∏ß/‡∏ñ‡∏π‡∏Å")
                            elif "pro" in model_name:
                                st.caption("üß† ‡∏â‡∏•‡∏≤‡∏î")
                else:
                    st.error("‚ùå ‡πÑ‡∏°‡πà‡∏û‡∏ö‡πÇ‡∏°‡πÄ‡∏î‡∏•‡∏ó‡∏µ‡πà‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö generateContent ‡πÄ‡∏•‡∏¢")
                    
            except Exception as e:
                st.error(f"‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡∏ï‡∏≠‡∏ô‡∏î‡∏∂‡∏á‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠: {e}")

except Exception as e:
    st.error("‚ö†Ô∏è ‡πÑ‡∏°‡πà‡∏û‡∏ö API Key ‡πÉ‡∏ô Secrets")
    st.info("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÑ‡∏ü‡∏•‡πå .streamlit/secrets.toml ‡∏´‡∏£‡∏∑‡∏≠‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÉ‡∏ô Streamlit Cloud")
